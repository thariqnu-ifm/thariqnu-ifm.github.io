<html>
	<div>
		<span id="dbg">F</span>
	</div>
	<textarea id="zz" autocapitalize="none" autocomplete="on" autofocus="true" 
		  placeholder="Start writing here" spellcheck="false" cols="99" rows="99"></textarea>
	<script type="text/javascript">
document.getElementById('zz').onkeydown = function(e) {
  if (e.key == 'Enter' || e.which == 13) {
    setTimeout(function(that) {
      var start = that.selectionStart;
      var v = that.value;
      var thisLine = '';
      for (var i = start - 2; i >= 0 && v[i] != '\n'; i--) {
        thisLine = v[i] + thisLine;
      }
      var indentation = thisLine.substring(0, thisLine.length - thisLine.trimLeft().length);
      that.value = (v.slice(0, start) + indentation + v.slice(start));
      that.selectionStart = that.selectionEnd = start + indentation.length;
    }, 0.01, this);
  }
};
	</script>
</html>
