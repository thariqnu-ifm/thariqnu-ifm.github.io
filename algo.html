<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<div>
	<a href="https://github.com/thariqnu-ifm/thariqnu-ifm.github.io/archive/master.zip" download="algo.zip"><button type="button">HTML</button></a>
	<button id="simpan" type="button">Save</button>
	<button id="undo" type="button">Undo</button>
	<button id="bawah" type="button">bottom</button>
</div>
<textarea autocapitalize=none autocomplete=on autofocus cols=150 id=zz placeholder="Start writing here"rows=10 spellcheck=false></textarea>

<script>
	var zz=document.getElementById("zz");
	var simpan=document.getElementById("simpan");
	function save(manual) { 
		localStorage.setItem("a",zz.value);
		if(manual===true) {
			localStorage.setItem("save",zz.value);
			simpan.style.color = 'black';
		}
	}
	var downContent=zz.value=localStorage.getItem("a")||"";
	function autosave(){
		setTimeout(function(){
			save();
			autosave();
			simpan.style.color = 'red';
		},1e4);
	}
	//
	zz.onkeydown=function(e){downContent=zz.value,"Enter"!=e.key&&13!=e.which||setTimeout(function(e){var t=e.selectionStart;if(0!=t){for(var n=e.value,i="",l=t-2;0<=l&&"\n"!=n[l];l--)i=n[l]+i;var a=i.substring(0,i.length-i.trimLeft().length),o=i.trimRight().slice(-1);-1<":{([".indexOf(o)&&(a+=" "),e.value=n.slice(0,t)+a+n.slice(t),e.selectionStart=e.selectionEnd=t+a.length}},100,this)};var pairs={"(":")","{":"}","[":"]","'":"'",'"':'"'};zz.onkeyup=function(e){var t=zz.value;if(!(t.length<=downContent.length)){var n=zz.selectionStart;if(0!=n){var i=t[n-1],l=pairs[i];l?(zz.value=t.slice(0,n)+l+t.slice(n),zz.selectionStart=zz.selectionEnd=n):" "==i&&1<n&&n<t.length&&pairs[t[n-2]]==t[n]&&(zz.value=t.slice(0,n-1)+t.slice(n),zz.selectionStart=zz.selectionEnd=n),downContent=zz.value}}};
	//
	function fks() {
		zz.blur();
		zz.focus();
	}
	function btm() {
		zz.selectionStart=zz.selectionEnd=zz.value.length;
		fks();
	}
	function postinit() {
		autosave();
		simpan.onclick=function(){
			save(true);
			fks();
		};
		document.getElementById("bawah").onclick=btm;
		zz.onblur=function(){save();};
		setTimeout(function(){btm();},100);
		document.getElementById("undo").onclick=function() {
			var val = localStorage.getItem("save");
			if(val) {
				downContent=zz.value=val;
				setTimeout(function(){btm();},100);
				simpan.style.color = 'black';
			}
		}
	}
	postinit();
</script>
